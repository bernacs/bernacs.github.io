function scanlineDiff(a){var b=-$(window).height()/4,c=$(window).scrollTop()+$(window).height()/2+b,d=$(a).offset().top+$(a).height()/2,e=Math.abs(d-c);return e}function changeCurrent(){if($("section.work").removeClass("current"),$(".in-view"))if($(window).height()<=1440){var a=[].reduce.call($(".in-view"),function(a,b){return scanlineDiff($(a))<scanlineDiff($(b))?a:b});$(a).addClass("current")}else $(".in-view").first().addClass("current");var b=$("section.current").data("work");$("nav li.work").removeClass("current-nav").each(function(a,c){var d=$(c).find("a").attr("href").split(/[#/]/).clean(""),e=$(location).attr("pathname").split("/").clean("");e.first()==d.first()&&d.last()==b&&$(c).addClass("current-nav")})}$(document).ready(function(){$(".content section.work").appear({'force_process': true}),$(".content").on("appear","section.work",function(a,b){a.preventDefault(),b.each(function(){$(this).addClass("in-view")}),changeCurrent()}),$(".content").on("disappear","section.work",function(a,b){a.preventDefault(),b.each(function(){$(this).removeClass("in-view")}),changeCurrent()})}),Array.prototype.clean=function(a){for(var b=0;b<this.length;b++)this[b]==a&&(this.splice(b,1),b--);return this},Array.prototype.first=function(){return this[0]},Array.prototype.last=function(){return this[this.length-1]};